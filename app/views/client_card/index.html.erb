<% provide(:title, @client.ClientName) %>
<div class="card-name">
  <h3>
    <span class="group-ico"></span> <%= @client.ClientName %> <%= @client.client_property.try(:ClientPropertyName) ||"" %>
    <small><span class="edit" value="/client/{{$client->ClientId}}/edit_name" title="Редактировать название"></span>
    </small>
  </h3>
</div>
<!--#editContactClick для jquery class utilContact !-->
<div id="editContactClick" class="row">


  <div class="col-md-6">


    <div class="row">
      <?
                    //print $client;
                ?>
      <div class="col-md-4">Телефон:
        <span class="plus-mid" value="/client/{{$client->ClientId}}/add_telephone" title="Добавить телефон"></span>
      </div>
      <div id="toggle" class="col-md-6">
        <ul class="list-unstyled">

          <% @client.telephones.each do |telephone|%>
              <li><span class="phone">
              <%= telephone.try(:AttrTelephone)%>
              </span>
                <span class="label label-default"><%= telephone.try(:DopName)%></span>
                <span class="edit" value="/edit_telephone/{{$t->IDTelephone}}" title="Редактировать телефон"></span>
                <span value="/remove_telephone/{{$t->IDTelephone}}" class="delete"></span></li>
              <% end %>



        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">E-mail:
        <span class="plus-mid" value="/client/{{$client->ClientId}}/add_email" title="Добавить e-mail"></span></div>
      <div id="toggle" class="col-md-6">
        <ul class="list-unstyled">
          <% @client.emails.each do |em|%>
              <%= p em.AttrEmail%>
              <li><span class="mail"><%= p em.AttrEmail%></span> <span class="label label-default"><%= p em.DopInfo%></span>
                <span class="edit" value="/edit_email/{{$t->IDEmail}}" title="Редактировать e-mail"></span>
                <span value="/remove_email/{{$t->IDEmail}}" class="delete"></span></li>
          <% end %>


        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-6">Ссылки:
        <span class="plus-mid" value="/client/{{$client->ClientId}}/add_link" title="Добавить ссылку"></span></div>
      <div id="toggle" class="col-md-6">
        <ul class="list-unstyled">


          <% @client.links.each do |em|%>

              <li><span class="link"><a href="<?=$h?>{{ $t->AttrLink }}" target="_blank"> <%= p em.AttrLink%></a></span>
                <span class="label label-default"><%= p em.DopInfo%></span>
                <span class="edit" value="/edit_link/{{$t->IDLink}}" title="Редактировать ссылку"></span>
                <span value="/remove_link/{{$t->IDLink}}" class="delete"></span></li>
          <% end %>

        </ul>
      </div>
    </div>
    <div class="separator"></div>
    <h4>О
      компании<span value="/client/{{$client->ClientId}}/edit_info" title="Редактировать о компании" class="edit "></span>
    </h4>
    <div class="row">
      <div class="col-md-6">Тип:</div>
      <div class="col-md-6"><p><%= @client.client_type.try(:ClientTypeName) %></p></div>

    </div>
    <div class="row">
      <div class="col-md-6">Вид:</div>
      <div class="col-md-6"><p><%= @client.client_vid.try(:ClientVidName) || 'nil' %></p></div>

    </div>
    <div class="row">
      <div class="col-md-6">Публичное наименование:</div>
      <div class="col-md-6"><p><%= @client.ClientPublicName %></p></div>
    </div>

    <div class="row">
      <div class="col-md-6">Рабочее наименование:</div>
      <div class="col-md-6"><p><%= @client.ClientWorkName %></p></div>
    </div>
    <div class="row">
      <div class="col-md-6">Дата основания:</div>
      <div class="col-md-6"><p><%= @client.ClientBorn %></p></div>
    </div>


    <div class="row">
      <div class="col-md-6">Описание:</div>
      <div class="col-md-6"><p><%= @client.ClientInfo %></p></div>

    </div>
    <div class="separator"></div>
    <div class="row">
      <div class="col-md-6">Примечание:</div>
      <div class="col-md-6"><p><%= @client.ClientInfoContr %></p></div>

    </div>
    <div class="separator"></div>
    <div class="row">
      <div class="col-md-5">Контакты:
        <span class="plus-mid" value="/client/{{$client->ClientId}}/add_contact" title="Добавить контакт"></span></div>
      <div class="col-md-7">
        <ul class="list-unstyled">
          <% @client.contacts.each do |contact| %>
              <li class="work_mp">
                <span class="forward">
                  <a href="/contact/<%= contact.try(:IDContact) %>">
                    <%= contact.try(:FamilyContact) %>
                    <%= contact.try(:NameContact) %>
                    <%= contact.try(:SoNameContact) %>
              </a>
                  <p id="work"><%= contact.try(:PostContact) %> </p>
                </span>

              </li>
          <% end %>


        </ul>
      </div>
    </div>
    <div class="separator"></div>
    <h4>Адреса

      <span class="plus-mid" value="/client/{{$client->ClientId}}/add_address" title="Добавить адрес"></span>
    </h4>


    <% @client.addresses.each do |ad|%>


    <div class="row">
      <div class="col-md-6"> <%= ad.try(:comment_address) %></div>
      <div class="col-md-6">
        <p><span class="edit" value="/client/{{$t->id_address }}/edit_address" title="Редактировать название"></span>

          <%= ad.try(:index_address) %>
          <%= ad.try(:sub_address) %>
          <%= ad.try(:city_address) %>
          <%= ad.try(:street_address) %>
          <%= ad.try(:home_address) %>
          <%= ad.try(:korp_address) %>
          <%= ad.try(:kv_address) %> </p>



        </div>
    </div>
    <% end %>


    <div class="separator"></div>


    @endforeach


    <div class="row">
      <div class="col-md-6">Индекс:</div>
      <div class="col-md-6"><p><%= @client.ClientIndex %></p></div>
    </div>
    <div class="row">
      <div class="col-md-6">Адрес:</div>
      <div class="col-md-6"><p><%= @client.ClientAddress %></p></div>
    </div>
    <div class="row">
      <div class="col-md-6">Город:</div>
      <div class="col-md-6"><p><%= @client.ClientCity %></p></div>
    </div>

    <div class="separator"></div>


  </div>


  <div class="col-md-6">


    <div>

      <!-- Nav tabs -->
      <ul class="nav nav-tabs" role="tablist">

        <li role="presentation" class="active">
          <a href="#call" aria-controls="home" role="tab" data-toggle="tab"><span class="headset-mid"></span> Звонки</a>
        </li>
        <li role="presentation">
          <a href="#bills" aria-controls="profile" role="tab" data-toggle="tab"><span class="money-mid"></span>
            Счета</a></li>
        <li role="presentation">
          <a href="#purchase" aria-controls="profile" role="tab" data-toggle="tab"><span class="cart-mid"></span> Торги</a>
        </li>

        <li role="presentation">
          <a href="#settings" aria-controls="settings" role="tab" data-toggle="tab"><span class="timer-mid"></span>
            История</a></li>
        <li role="presentation">
          <a href="#settings" aria-controls="settings" role="tab" data-toggle="tab"><span class="folder-mid"></span>
            Файлы</a></li>
      </ul>
      <div class="margin-10px-top"></div>

      <!-- Tab panes -->
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="call">
          <button class="btn btn-default btn-sm" id="addTrigger" type="submit" aria-label="" value="/call/add/client/{{$client->ClientId}}" title="Добавить">Добавить</button>
          <div class="margin-10px-top"></div>
          <% @calls.each do |call|%>
              <%= %>
          <div class="row">

            <div class="col-md-12">
              <h5 class="<%= call.call_status.try(:callStatusColor)%>">
                <%= %>


                <%= call.call_status.try(:callStatusName)%>: <%= call.CallDate%> в
                <%= call.CallTime%> - usr @if

                <span class="label label-default"> <%= call.contact.try(:FamilyContact)%> <%= call.contact.try(:NameContact)%> <%= call.contact.try(:SoNameContact)%> </span>

                <span value="/call/edit/client/{{$t->CallID}}/{{$client->ClientId}}" title="Редактировать" class="edit "></span>
              </h5>
            </div>

          </div>
          <div class="separator"></div>
          <div class=""><%= call.try(:CallText)%></div>

          <div class="separator"></div>


              <% end %>


        </div>

        <div role="tabpanel" class="tab-pane" id="bills">
          <button class="btn btn-default btn-sm" type="submit" id="addTrigger" value="/bill/add/{{$client->ClientId}}" title="Добавить счет" aria-label="">Добавить</button>
          <div class="margin-10px-top"></div>


          <table class="table table-bordered table-hover">
            <thead>

            <tr>
              <th>№ счета</th>
              <th>Дата</th>
              <th>Дата оплаты</th>
              <th>Статус</th>
            </tr>
            </thead>
            <tbody>
            <% @client.bills.each do |b|%>
                <tr style="cursor: pointer" id="addTrigger" value="/bill/edit/{{$t->BillId}}" title="Редактировать счет {{$t->BillName}}">
                  <td> <%= b.try(:BillName) %></td>
                  <td> <%= b.try(:BillDataCreate) %></td>
                  <td><%= b.try(:BillDatePay) %></td>
                  <td><span class="label <%= b.bill_status.try(:BillStatusColor) || ''%>"><%= b.bill_status.try(:BillStatusName) %></span></td>

                </tr>



                <% end %>
            </tbody>
          </table>
        </div>
        <div role="tabpanel" class="tab-pane" id="purchase">
          <button class="btn btn-default btn-sm" type="submit" id="addTrigger" value="/purchase/add/{{$client->ClientId}}" title="Добавить торги" aria-label="">Добавить</button>
          <div class="margin-10px-top"></div>


          <table class="table table-bordered table-hover">
            <thead>

            <tr>
              <th>Наименование</th>
              <th>От</th>
              <th>Статус</th>
            </tr>
            </thead>
            <tbody>
            <% @client.purchases.each do |p|%>


            <tr style="cursor: pointer" id="addTrigger" value="/purchase/edit/{{$t->purchaseId}}" title="Редактировать {{$t->purchaseName}}">
              <td><%= p.try(:purchaseName)%></td>
              <td><%= p.try(:purchaseDateStart)%></td>
              <td><span class="label <%= p.purchase_status.try(:psColor)%>"><%= p.purchase_status.try(:psName)%></span></td>


            </tr>

            <% end %>


            </tbody>
          </table>

        </div>
        <div role="tabpanel" class="tab-pane" id="settings">
          <button class="btn btn-default btn-sm" type="submit" id="addTrigger" value="/file/add/client/{{$client->ClientId}}" title="Добавить файл" aria-label="">Добавить</button>
          <div class="margin-10px-top"></div>
          <table class="table">
            <thead>

            <tr>
              <th class="col-md-6">Название</th>
              <th class="col-md-2">Размер</th>
              <th class="col-md-3">Дата добавления</th>
            </tr>
            </thead>
            <tbody>
            @foreach ($client->files as $t)

            <tr>
              <td class="col-md-6"><a href="/file/get/{{$t->fileOriginalName}}">{{$t->fileOriginalName}}</a></td>
              <td class="col-md-2">{{$t->fileSize}}</td>
              <td class="col-md-3">{{$t->created_at}}</td>
            </tr>


            @endforeach

            </tbody>
          </table>

        </div>
      </div>

    </div>


  </div>
</div>


<!-- Modal -->
<div class="modal false modal" id="myModal" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">

  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
          ×
        </button>

        <h4 class="modal-title" id="myModalLabel">
          This Modal title
        </h4>
      </div>

      <div class="modal-body">

      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">
          Закрыть
        </button>

        <button type="button" class="btn btn-primary" id="Submit">
          Сохранить
        </button>
      </div>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->

</div><!-- /.modal -->


